{% extends "base.html" %}
{% block content %}
<h1>Alquileres (ordenados por fecha de entrega)</h1>

<div class="msg">
  <a class="btn" href="/alquileres/crear/">Crear alquiler</a>
  <a class="btn2" href="/">Menú</a>
</div>
<br>

<table>
  <thead>
    <tr>
      <th>#</th><th>Cliente</th><th>Tel</th><th>Prendas</th><th>Ruedos</th>
      <th>Entrega</th><th>Devolución</th>
      <th>Seña</th><th>Total</th><th>Saldo</th><th>Estado</th><th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    {% for a in alquileres %}
    <tr>
      <td>{{ a.id }}</td>
      <td>{{ a.cliente_nombre }}</td>
      <td>{{ a.cliente_telefono }}</td>
      <td>
        {% for p in a.prendas.all %}
          {{ p.descripcion }} ({{ p.codigo }}){% if not forloop.last %}<br>{% endif %}
        {% endfor %}
      </td>
      <td>
        {% if a.ruedo_saco %}Saco: {{ a.ruedo_saco }}<br>{% endif %}
        {% if a.ruedo_pantalon %}Pantalón: {{ a.ruedo_pantalon }}{% endif %}
      </td>
      <td>{{ a.fecha_entrega }}</td>
      <td>{{ a.fecha_devolucion }}</td>
      <td>${{ a.senia_monto }} ({{ a.senia_metodo }})</td>
      <td>${{ a.total }}</td>
      <td>${{ a.saldo_restante }} ({{ a.saldo_metodo }})</td>
      <td>
        <form method="post" action="/alquileres/{{ a.id }}/estado/">
          {% csrf_token %}
          <select name="estado">
            <option {% if a.estado == "Reservado" %}selected{% endif %}>Reservado</option>
            <option {% if a.estado == "Entregado" %}selected{% endif %}>Entregado</option>
            <option {% if a.estado == "Disponible" %}selected{% endif %}>Disponible</option>
          </select>
          <button class="btn2" type="submit">Guardar</button>
        </form>
      </td>
      <td>
        <a class="btn2" href="/alquileres/{{ a.id }}/borrar/">Borrar</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
